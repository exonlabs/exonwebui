/*
  :copyright: 2020, ExonLabs. All rights reserved.
  :license: BSD, see LICENSE for more details.
*/
var WebUI=function(c,l){return l.format_url=function(e){return"/"+e.replace(/^[\/#]/,"")},l.doctitle={base:document.title,update:function(e){void 0!==e&&0<e.length&&(e=e[0].toUpperCase()+e.slice(1),document.title=e+" | "+l.doctitle.base)},reset:function(){document.title=l.doctitle.base}},l.pagelock={show:function(e,o){l.pagelock.hide(),c("body").append('<div id="_UiPageLock" class="container-fluid overflow-auto scroll page-lock '+(o||"")+'">'+(e||"")+"</div>")},loading:function(e){return l.pagelock.show('<div class="row"><div class="col cancel"><a id="_UiPageLock_btnCancel"><i class="fas fa-times"></i></a></div></div>'+(e||""),"page-loading"),c("#_UiPageLock_btnCancel").on("click",function(){l.pagelock.hide()}),c("#_UiPageLock_btnCancel")},progress:function(e){if(!e)return l.pagelock.loading('<div class="row h-100 align-items-center justify-content-center"><div class="col-5"><div class="progress"><div class="progress-bar progress-bar-striped progress-bar-animated"></div></div></div></div>');c("#_UiPageLock .progress-bar").css("width",e+"%")},modal:function(e,o,t,n){l.pagelock.show('<div class="modal-dialog modal-dialog-centered '+(n||"")+'"><div class="modal-content"><div class="modal-header pt-2 pb-1">'+(e||"")+'<button class="close" onclick="WebUI.pagelock.hide()">Ã—</button></div><div class="modal-body scroll">'+(o||"")+(t?'</div><div class="modal-footer p-1">'+t+"</div></div></div>":""))},hide:function(){c("#_UiPageLock").length&&c("#_UiPageLock").remove()}},l.notify={stack:{dir1:"down",dir2:"left",push:"top",firstpos1:14,firstpos2:10,spacing1:7,spacing2:7},clear:PNotify.removeAll,show:function(e,o,t,n){t&&PNotify.removeAll(),window.innerWidth<576?(l.notify.stack.firstpos1=0,l.notify.stack.firstpos2=0):(l.notify.stack.firstpos1=14,l.notify.stack.firstpos2=10),"rtl"==c("html").attr("dir")||"rtl"==c("body").attr("dir")?l.notify.stack.dir2="right":l.notify.stack.dir2="left";var i={styling:"fontawesome",icon:!1,hide:!n,animate_speed:"fast",buttons:{sticker:!1,closer:!0},addclass:"stack-custom",stack:l.notify.stack};"error"==e?(i.type="error",i.text='<i class="fas fa-ta fa-exclamation-circle"></i> '+o):"warn"==e?(i.type="notice",i.text='<i class="fas fa-ta fa-exclamation-circle"></i> '+o):"success"==e?(i.type="success",i.text='<i class="fas fa-ta fa-check-circle"></i> '+o):(i.type="info",i.text='<i class="fas fa-ta fa-info-circle"></i> '+o);var r=new PNotify(i);r.get().click(function(){r.remove()})},error:function(e,o,t){l.notify.show("error",e,o,t)},warn:function(e,o,t){l.notify.show("warn",e,o,t)},info:function(e,o,t){l.notify.show("info",e,o,t)},success:function(e,o,t){l.notify.show("success",e,o,t)},load:function(e){for(var o=0;o<e.length;o++)l.notify.show(e[o][0],e[o][1],e[o][2],e[o][3])}},l.scrolltop=function(e){c("body").animate({scrollTop:0},e||300)},l.redirect=function(e,o){void 0!==e&&0<e.length&&("#"==e[0]?e==window.location.hash?c(window).trigger("hashchange"):window.location.hash=e:o?window.open(e):e==window.location?location.reload():window.location=e)},l.request=function(e,o,t,n,i,r,a){return c.ajax({url:l.format_url(o),type:e,data:t||{},contentType:!(t instanceof FormData)&&"application/x-www-form-urlencoded; charset=UTF-8",processData:!(t instanceof FormData),success:function(e,o,t){"function"==typeof n?n(e):(e.notifications&&l.notify.load(e.notifications),e.redirect&&l.redirect(e.redirect,e.blank))},error:function(e,o,t){"abort"==t?t="request cancelled":e.status?t||(t="request failed"):t="service unavailable","function"==typeof i?i(c.i18n._(t)):l.notify.error(c.i18n._(t))},complete:function(e,o){"function"==typeof r&&r()},xhr:function(){return"function"==typeof a?a():new window.XMLHttpRequest}})},l.loader={req_xhr:null,lock_timer:null,progress_timer:null,progress_xhr:null,load:function(e,o,t,n,i,r,a){l.loader.cancel(),l.loader.lock_timer=setTimeout(function(){l.pagelock.loading().off("click").on("click",function(e){l.loader.cancel()})},a||500),l.loader.req_xhr=l.request(e,o,t,n,i,function(){l.loader.reset(),l.pagelock.hide(),"function"==typeof r&&r()})},progress:function(e,o,t,n,i,r,a,c){l.loader.cancel(),l.loader.lock_timer=setTimeout(function(){l.pagelock.progress().off("click").on("click",function(e){l.loader.cancel()}),l.loader.progress_timer=setInterval(function(){null===l.loader.progress_xhr&&(l.loader.progress_xhr=l.request(e,o,{_csrf_token:Cookies.get("_csrf_token"),get_progress:1},function(e){l.pagelock.progress(e.payload)},function(e){},function(){l.loader.progress_xhr=null}))},c||5e3)},a||500),l.loader.req_xhr=l.request(e,o,t,n,i,function(){l.loader.reset(),l.pagelock.progress(100),setTimeout(function(){l.pagelock.hide(),"function"==typeof r&&r()},400)})},formsubmit:function(e,o,t,n,i){l.loader.cancel();var r=l.pagelock.progress;l.loader.lock_timer=setTimeout(function(){r().off("click").on("click",function(e){l.loader.cancel()})},i||500),l.loader.req_xhr=l.request(e.attr("method"),e.attr("action"),new FormData(e[0]),o,t,function(){l.loader.reset(),l.pagelock.hide(),"function"==typeof n&&n()},function(){var e=new window.XMLHttpRequest;return e.upload.addEventListener("progress",function(e){if(e.lengthComputable){var o=parseInt(e.loaded/e.total*100);if(o<100)return l.pagelock.progress(o),null;l.pagelock.progress(100)}r=l.pagelock.loading},!1),e})},cancel:function(){l.loader.req_xhr&&l.loader.req_xhr.abort()},reset:function(){l.loader.lock_timer&&clearTimeout(l.loader.lock_timer),l.loader.progress_timer&&clearTimeout(l.loader.progress_timer),l.loader.req_xhr=null,l.loader.lock_timer=null,l.loader.progress_timer=null}},l.getScript=function(n,t,i){c.getScript(n).done(function(e,o){"function"==typeof t&&t()}).fail(function(e,o,t){console.error("failed loading "+n+" ["+t+"]"),"function"==typeof i?i(result):l.notify.warn("Not all page contents loaded !<br>Please refresh page and try again.",null,!0)})},l.init=function(){c.ajaxSetup({cache:!0});var e=c("html").attr("lang");e&&"undefined"!=typeof webui_i18n&&c.i18n.load(webui_i18n,e)},l}(jQuery,WebUI||{});